<!DOCTYPE html>
<html ng-app>
<head>
    <style>
        ul {
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            text-align: left;
        }
        li {
            width: 40px;
            padding-left: 5px;
            padding-right: 5px;
            display: inline-block;
            vertical-align: top;
            text-align: center;
            background-color: #99DDBB;
            border: 1px solid #000000;
            border-radius: 15px;
        }

        .fretBoard {
            display: table;
        }

        .string {
            display:table-row;
            /*height: 10px;*/
        }
        .spot {
            position: relative;
            display: inline-block;
            width: 32px;
            height: 20px;
            margin: -2px 0 -2px 0;
            background-color: rgba(114, 184, 197, 0.23);
            border: 1px solid #5b919c;
            /*border-radius: 15px;*/
        }


        .spotInner {
            position:absolute;
            width: 25px;
            margin: 2px 0 2px 10px;
        }

        .played {
            position: absolute;
            width: 25px;
            margin: 2px 0 2px 4px;
            background-color: rgba(91, 145, 156, 0.36);
            border-radius: 12px;
        }

    </style>
    <script src="public/lib/angular/angular.js"></script>
    <script>

        var stringLength = 13

        var flats = true

        var intNames =
            ['1','b9','9','b3','3','4','b5','5','#5','6','b7','7']

        var noteNames =
            [
                {flat: 'C', sharp:'C'},
                {flat: 'Db', sharp:'C#'},
                {flat: 'D', sharp:'D'},
                {flat: 'Eb', sharp:'D#'},
                {flat: 'E', sharp:'E'},
                {flat: 'F', sharp:'F'},
                {flat: 'Gb', sharp:'F#'},
                {flat: 'G', sharp:'G'},
                {flat: 'Ab', sharp:'G#'},
                {flat: 'A', sharp:'A'},
                {flat: 'Bb', sharp:'A#'},
                {flat: 'B', sharp:'B'}
            ]

        // These are the instruments.  They need to have their strings populated
        // from the algorithm.
        var guitar = {
            name: 'Guitar',
            openStrings: [4, 11, 7, 2, 9,  4],
            strings: []
        }
        var fiddle = {
            name: 'Fiddle',
            openStrings: [4, 9, 2, 7],
            strings: []
        }
        var ukulele = {
            name: 'Ukulele',
            openStrings: [9, 4, 0, 7],
            strings: []
        }
        var bass = {
            name: 'Bass',
            openStrings: [7, 2, 9, 4],
            strings: []
        }
        var dobro = {
            name: 'Dobro',
            openStrings: [2, 11, 7, 2, 11, 7],
            strings: []
        }

        function prepString(instrument, stringNum) {
//            console.log(instrument, stringNum)
            var string = [];
            var ptr = instrument.openStrings[stringNum];
            for (var i=0; i<stringLength; i++) {
                var spotNoteName = flats ? noteNames[ptr].flat : noteNames[ptr].sharp
                var spot = {note: spotNoteName, played: false}
                string.push(spot)
                //console.log(intNames[ptr])
                ptr++
                if (ptr > 11) {
                    ptr = 0
                }
            }
            return string
        }

        function getInstrument (instrument) {
            instrument.strings = []
            for (var i=0; i<instrument.openStrings.length; i++) {
                var string = prepString(instrument,i)
                instrument.strings.push(string)
            }
            return instrument
        }

        function FretsController($scope) {

            $scope.instrument = getInstrument(guitar)

            $scope.checked = true

            $scope.clicked = function(spot) {
                spot.played = !spot.played
                console.log(spot.note + " " + spot.played)
            }
        }
    </script>
</head>

<body>

<div ng-controller="FretsController">

    <br>

    <form>
        <input type="checkbox" ng-model="checked">
        <input type="submit" ng-click="clicked()"/>
    </form>

<br><br>
 {{instrument.name}}
 <br>
 <br>


    <div class="fretBoard">
        <div class="string" ng-repeat="string in instrument.strings">
            <div class="spot" ng-repeat="spot in string">
                <div class="spotInner" ng-click="clicked(spot)">
                    {{spot.note}}
                </div>
                <div class="played" ng-click="clicked(spot)">
                   &nbsp;
                </div>
            </div>
        </div>
    </div>



</div>

</body>
</html>